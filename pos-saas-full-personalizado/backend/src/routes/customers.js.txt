export async function handleCustomers(request, env) {
  const url = new URL(request.url);
  const path = url.pathname;

  if (request.method === 'GET' && path === '/api/customers') {
    const results = await env.DB.prepare('SELECT * FROM customers').all();
    return new Response(JSON.stringify(results), {
      headers: { 'Content-Type': 'application/json' },
    });
  }

  if (request.method === 'POST' && path === '/api/customers') {
    const body = await request.json();
    const { name, email, phone, company_id } = body;

    await env.DB.prepare(
      'INSERT INTO customers (name, email, phone, company_id) VALUES (?, ?, ?, ?)'
    )
      .bind(name, email, phone, company_id)
      .run();

    return new Response(JSON.stringify({ success: true }), {
      headers: { 'Content-Type': 'application/json' },
    });
  }

  return new Response('Ruta no encontrada', { status: 404 });
}